{
  "arcs": [
    {
      "direction": "IN",
      "expression": "query",
      "id": "e-fxz84",
      "multiplicity": 1,
      "sourceId": "pStock",
      "targetId": "tSpot"
    },
    {
      "direction": "OUT",
      "expression": "tool_result",
      "id": "aRes",
      "multiplicity": 1,
      "sourceId": "tSpot",
      "targetId": "pYf"
    },
    {
      "direction": "IN",
      "expression": "token",
      "id": "aIRfq",
      "multiplicity": 1,
      "sourceId": "pInitRFQ",
      "targetId": "tRFQInput"
    },
    {
      "direction": "OUT",
      "expression": "aRfq",
      "id": "aRfq",
      "multiplicity": 1,
      "sourceId": "tRFQInput",
      "targetId": "pRFQ"
    },
    {
      "direction": "IN",
      "expression": "token",
      "id": "aOSpot",
      "multiplicity": 1,
      "sourceId": "pYf",
      "targetId": "tAI"
    },
    {
      "direction": "IN",
      "expression": "token",
      "id": "aORfq",
      "multiplicity": 1,
      "sourceId": "pRFQ",
      "targetId": "tAI"
    },
    {
      "direction": "OUT",
      "expression": "func A_aAI_expr(answer interface{}) interface{} {\n\t// Arc expression: answer\n\treturn answer\n}",
      "id": "aAI",
      "multiplicity": 1,
      "sourceId": "tAI",
      "targetId": "pAI"
    }
  ],
  "colorSets": [
    "colset STR = string;",
    "colset J = json;",
    "colset REAL = real;",
    "colset INT = int;",
    "colset Quote = json;",
    "colset Order = json;",
    "colset RFQ = json<RFQ>;",
    "colset RFQ = json;",
    "colset STRING = string;",
    "colset JSON = string;",
    "colset MARKDOWN = string;",
    "colset AnyData = json;",
    "colset OrderTyped = json<OrderSchema>;",
    "colset Product = json<ProductSchema>;",
    "colset Status = string;",
    "colset Amount = int;"
  ],
  "currentStep": 0,
  "description": "",
  "globalClock": 0,
  "id": "Trade",
  "initialMarking": {
    "pAI": [
      {
        "timestamp": 0,
        "value": "**Opinion:** Cautious  \n\n**Rationale:** The 30‑day call is struck at $105 while AAPL is trading around $270 – more than 2½ × the strike – and the assumed volatility (20 %) is modest. The probability of the stock falling back below the strike before expiry is extremely low, so the option’s price is dominated by time decay with little upside potential. Even though the underlying shows strong momentum and healthy fundamentals, this particular contract is far out‑of‑the‑money and not an attractive buy."
      }
    ]
  },
  "jsonSchemas": [
    {
      "name": "RFQ",
      "schema": {
        "$schema": "https://json-schema.org/draft-07/schema",
        "description": "Generated from JSON data",
        "properties": {
          "KOLevel": {
            "type": "integer"
          },
          "Maturity": {
            "type": "integer"
          },
          "PathNum": {
            "type": "integer"
          },
          "Rate": {
            "type": "number"
          },
          "ReqID": {
            "type": "string"
          },
          "Spot": {
            "type": "integer"
          },
          "Strike": {
            "type": "integer"
          },
          "Underlying": {
            "type": "string"
          },
          "Vol": {
            "type": "number"
          }
        },
        "required": [
          "KOLevel",
          "Maturity",
          "PathNum",
          "Rate",
          "ReqID",
          "Spot",
          "Strike",
          "Underlying",
          "Vol"
        ],
        "title": "Generated Schema",
        "type": "object"
      }
    },
    {
      "name": "Order",
      "schema": {
        "$schema": "https://json-schema.org/draft-07/schema",
        "description": "Generated from JSON data",
        "properties": {
          "AIOpinion": {
            "description": "",
            "type": "string"
          },
          "Amount": {
            "description": "",
            "type": "number"
          },
          "KOLevel": {
            "type": "integer"
          },
          "Maturity": {
            "type": "integer"
          },
          "Rate": {
            "type": "number"
          },
          "Spot": {
            "type": "integer"
          },
          "Strike": {
            "type": "integer"
          },
          "Underlying": {
            "type": "string"
          },
          "Vol": {
            "type": "number"
          }
        },
        "required": [
          "KOLevel",
          "Maturity",
          "Rate",
          "Spot",
          "Strike",
          "Underlying",
          "Vol"
        ],
        "title": "Generated Schema",
        "type": "object"
      }
    },
    {
      "name": "OrderSchema",
      "schema": {
        "properties": {
          "customerId": {
            "description": "Customer identifier",
            "type": "string"
          },
          "items": {
            "description": "Order items",
            "items": {
              "properties": {
                "price": {
                  "type": "number"
                },
                "productId": {
                  "type": "string"
                },
                "quantity": {
                  "type": "integer"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "orderId": {
            "description": "Unique order identifier",
            "type": "string"
          },
          "status": {
            "enum": [
              "pending",
              "processing",
              "completed",
              "cancelled"
            ],
            "type": "string"
          },
          "total": {
            "description": "Order total amount",
            "type": "number"
          }
        },
        "required": [
          "orderId",
          "customerId",
          "total"
        ],
        "type": "object"
      }
    },
    {
      "name": "ProductSchema",
      "schema": {
        "properties": {
          "price": {
            "type": "number"
          },
          "productId": {
            "type": "string"
          }
        },
        "required": [
          "productId",
          "price"
        ],
        "type": "object"
      }
    }
  ],
  "name": "Trade",
  "places": [
    {
      "colorSet": "J",
      "id": "pStock",
      "name": "StockSymbol",
      "position": {
        "x": 120,
        "y": 80
      }
    },
    {
      "colorSet": "J",
      "id": "pYf",
      "name": "pYf",
      "position": {
        "x": 640,
        "y": 80
      }
    },
    {
      "colorSet": "J",
      "id": "pInitRFQ",
      "name": "pInitRFQ",
      "position": {
        "x": 120,
        "y": 200
      }
    },
    {
      "colorSet": "J",
      "id": "pRFQ",
      "name": "pRFQ",
      "position": {
        "x": 549.4166,
        "y": 193.66667
      }
    },
    {
      "colorSet": "STRING",
      "id": "pAI",
      "name": "pAI",
      "position": {
        "x": 1070.8068,
        "y": 138.5037
      }
    }
  ],
  "status": "loaded",
  "transitions": [
    {
      "Tools": [
        {
          "name": "mcp:https://data.lizhao.net/api/mcp:yahoo_quote"
        }
      ],
      "guardExpression": "true",
      "id": "tSpot",
      "kind": "Tools",
      "name": "tSpot",
      "position": {
        "x": 324.5,
        "y": 97
      }
    },
    {
      "actionFunction": "func T_tRFQInput_action(aIRfq map[string]interface{}, formData map[string]interface{}) map[string]interface{} {\n    base := make(map[string]interface{})\n    if aIRfq != nil {\n        for k, v := range aIRfq {\n            base[k] = v\n        }\n    }\n    if formData != nil {\n        for k, v := range formData {\n            base[k] = v\n        }\n    }\n    return base\n}",
      "guardExpression": "true",
      "id": "tRFQInput",
      "kind": "Manual",
      "name": "tRFQInput",
      "position": {
        "x": 258.12268,
        "y": 222.81293
      }
    },
    {
      "LlmOptions": {},
      "LlmTemplate": {
        "messages": [
          {
            "text": "You are an experienced financial adviser specializing in listed equity option trading. Provide a concise qualitative opinion (bullish / neutral / cautious) and one short rationale.",
            "type": "system"
          },
          {
            "text": "Based on current market environment, is the following option good to buy?\n{{aORfq}}, especially give comment on current spot price info at {{aOSpot}}",
            "type": "user"
          }
        ]
      },
      "guardExpression": "true",
      "id": "tAI",
      "kind": "LLM",
      "name": "tAI",
      "position": {
        "x": 794.25464,
        "y": 161.63455
      }
    }
  ]
}