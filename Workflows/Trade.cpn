{
  "id": "Trade",
  "name": "Trade",
  "description": "",
  "colorSets": [
    "colset STR = string;",
    "colset J = json;",
    "colset REAL = real;",
    "colset INT = int;",
    "colset Quote = json;",
    "colset Order = json;",
    "colset RFQ = json<RFQ>;",
    "colset RFQ = json;",
    "colset STRING = string;",
    "colset JSON = string;",
    "colset MARKDOWN = string;",
    "colset AnyData = json;",
    "colset OrderTyped = json<OrderSchema>;",
    "colset Product = json<ProductSchema>;",
    "colset Status = string;",
    "colset Amount = int;"
  ],
  "jsonSchemas": [
    {
      "name": "RFQ",
      "schema": {
        "$schema": "https://json-schema.org/draft-07/schema",
        "description": "Generated from JSON data",
        "properties": {
          "KOLevel": {
            "type": "integer"
          },
          "Maturity": {
            "type": "integer"
          },
          "PathNum": {
            "type": "integer"
          },
          "Rate": {
            "type": "number"
          },
          "ReqID": {
            "type": "string"
          },
          "Spot": {
            "type": "integer"
          },
          "Strike": {
            "type": "integer"
          },
          "Underlying": {
            "type": "string"
          },
          "Vol": {
            "type": "number"
          }
        },
        "required": [
          "KOLevel",
          "Maturity",
          "PathNum",
          "Rate",
          "ReqID",
          "Spot",
          "Strike",
          "Underlying",
          "Vol"
        ],
        "title": "Generated Schema",
        "type": "object"
      }
    },
    {
      "name": "Order",
      "schema": {
        "$schema": "https://json-schema.org/draft-07/schema",
        "description": "Generated from JSON data",
        "properties": {
          "AIOpinion": {
            "description": "",
            "type": "string"
          },
          "Amount": {
            "description": "",
            "type": "number"
          },
          "KOLevel": {
            "type": "integer"
          },
          "Maturity": {
            "type": "integer"
          },
          "Rate": {
            "type": "number"
          },
          "Spot": {
            "type": "integer"
          },
          "Strike": {
            "type": "integer"
          },
          "Underlying": {
            "type": "string"
          },
          "Vol": {
            "type": "number"
          }
        },
        "required": [
          "KOLevel",
          "Maturity",
          "Rate",
          "Spot",
          "Strike",
          "Underlying",
          "Vol"
        ],
        "title": "Generated Schema",
        "type": "object"
      }
    },
    {
      "name": "OrderSchema",
      "schema": {
        "properties": {
          "customerId": {
            "description": "Customer identifier",
            "type": "string"
          },
          "items": {
            "description": "Order items",
            "items": {
              "properties": {
                "price": {
                  "type": "number"
                },
                "productId": {
                  "type": "string"
                },
                "quantity": {
                  "type": "integer"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "orderId": {
            "description": "Unique order identifier",
            "type": "string"
          },
          "status": {
            "enum": [
              "pending",
              "processing",
              "completed",
              "cancelled"
            ],
            "type": "string"
          },
          "total": {
            "description": "Order total amount",
            "type": "number"
          }
        },
        "required": [
          "orderId",
          "customerId",
          "total"
        ],
        "type": "object"
      }
    },
    {
      "name": "ProductSchema",
      "schema": {
        "properties": {
          "price": {
            "type": "number"
          },
          "productId": {
            "type": "string"
          }
        },
        "required": [
          "productId",
          "price"
        ],
        "type": "object"
      }
    }
  ],
  "places": [
    {
      "id": "pStock",
      "name": "StockSymbol",
      "colorSet": "J",
      "position": {
        "x": 120,
        "y": 80
      }
    },
    {
      "id": "pYf",
      "name": "pYf",
      "colorSet": "J",
      "position": {
        "x": 640,
        "y": 80
      }
    },
    {
      "id": "pInitRFQ",
      "name": "pInitRFQ",
      "colorSet": "J",
      "position": {
        "x": 120,
        "y": 200
      }
    },
    {
      "id": "pRFQ",
      "name": "pRFQ",
      "colorSet": "J",
      "position": {
        "x": 549.4166,
        "y": 193.66667
      }
    },
    {
      "id": "pAI",
      "name": "pAI",
      "colorSet": "STRING",
      "position": {
        "x": 1124.1484543460658,
        "y": 137.4828056031746
      }
    }
  ],
  "transitions": [
    {
      "id": "tSpot",
      "name": "tSpot",
      "kind": "Tools",
      "guardExpression": "true",
      "scriptLanguage": "go",
      "position": {
        "x": 324.5,
        "y": 97
      },
      "Tools": [
        {
          "name": "mcp:https://data.lizhao.net/api/mcp:yahoo_quote"
        }
      ]
    },
    {
      "id": "tRFQInput",
      "name": "tRFQInput",
      "kind": "Manual",
      "guardExpression": "true",
      "scriptLanguage": "go",
      "position": {
        "x": 258.12268,
        "y": 222.81293
      },
      "actionFunction": "func T_tRFQInput_action(aIRfq map[string]interface{}, formData map[string]interface{}) map[string]interface{} {\n    base := make(map[string]interface{})\n    if aIRfq != nil {\n        for k, v := range aIRfq {\n            base[k] = v\n        }\n    }\n    if formData != nil {\n        for k, v := range formData {\n            base[k] = v\n        }\n    }\n    return base\n}"
    },
    {
      "id": "tAI",
      "name": "tAI",
      "kind": "LLM",
      "guardExpression": "true",
      "scriptLanguage": "go",
      "position": {
        "x": 794.25464,
        "y": 161.63455
      },
      "LlmTemplate": {
        "messages": [
          {
            "text": "You are an experienced financial adviser specializing in listed equity option trading. Provide a concise qualitative opinion (bullish / neutral / cautious) and one short rationale.",
            "type": "system"
          },
          {
            "text": "Based on current market environment, is the following option good to buy?\n{{aORfq}}, especially give comment on current spot price info at {{aOSpot}}",
            "type": "user"
          }
        ]
      },
      "LlmVars": {},
      "LlmOptions": {},
      "Stream": false
    }
  ],
  "arcs": [
    {
      "id": "e-fxz84",
      "sourceId": "pStock",
      "targetId": "tSpot",
      "expression": "query",
      "direction": "IN",
      "scriptLanguage": "go"
    },
    {
      "id": "aRes",
      "sourceId": "tSpot",
      "targetId": "pYf",
      "expression": "tool_result",
      "direction": "OUT",
      "scriptLanguage": "go"
    },
    {
      "id": "aIRfq",
      "sourceId": "pInitRFQ",
      "targetId": "tRFQInput",
      "expression": "token",
      "direction": "IN",
      "scriptLanguage": "go"
    },
    {
      "id": "aRfq",
      "sourceId": "tRFQInput",
      "targetId": "pRFQ",
      "expression": "aRfq",
      "direction": "OUT",
      "scriptLanguage": "go"
    },
    {
      "id": "aOSpot",
      "sourceId": "pYf",
      "targetId": "tAI",
      "expression": "aOSpot",
      "direction": "IN",
      "scriptLanguage": "go"
    },
    {
      "id": "aORfq",
      "sourceId": "pRFQ",
      "targetId": "tAI",
      "expression": "aORfq",
      "direction": "IN",
      "scriptLanguage": "go"
    },
    {
      "id": "aAI",
      "sourceId": "tAI",
      "targetId": "pAI",
      "expression": "func A_aAI_expr(aORfq map[string]interface{}, answer string) interface{} {\n    if aORfq == nil {\n        aORfq = make(map[string]interface{})\n    }\n    aORfq[\"AIOpinion\"] = answer\n    return aORfq\n}",
      "direction": "OUT",
      "scriptLanguage": "go"
    }
  ],
  "endPlaces": [],
  "initialMarking": {
    "pYf": [
      {
        "value": {
          "content": [
            {
              "text": [
                {
                  "ask": 270.48,
                  "askSize": 2,
                  "averageAnalystRating": "2.0 - Buy",
                  "averageDailyVolume10Day": 50905660,
                  "averageDailyVolume3Month": 53143573,
                  "bid": 269.96,
                  "bidSize": 1,
                  "bookValue": 4.991,
                  "corporateActions": [
                    {
                      "header": "Dividend",
                      "message": "AAPL announced a cash dividend of 0.26 with an ex-date of Nov. 10, 2025",
                      "meta": {
                        "amount": "0.26",
                        "dateEpochMs": 1762750800000,
                        "eventType": "DIVIDEND"
                      }
                    }
                  ],
                  "cryptoTradeable": false,
                  "currency": "USD",
                  "customPriceAlertConfidence": "HIGH",
                  "displayName": "Apple",
                  "dividendDate": "2025-11-13T00:00:00.000Z",
                  "dividendRate": 1.04,
                  "dividendYield": 0.38,
                  "earningsCallTimestampEnd": 1761858000,
                  "earningsCallTimestampStart": 1761858000,
                  "earningsTimestamp": "2025-10-30T20:00:00.000Z",
                  "earningsTimestampEnd": "2026-01-29T21:00:00.000Z",
                  "earningsTimestampStart": "2026-01-29T21:00:00.000Z",
                  "epsCurrentYear": 8.20994,
                  "epsForward": 8.31,
                  "epsTrailingTwelveMonths": 7.46,
                  "esgPopulated": false,
                  "exchange": "NMS",
                  "exchangeDataDelayedBy": 0,
                  "exchangeTimezoneName": "America/New_York",
                  "exchangeTimezoneShortName": "EST",
                  "fiftyDayAverage": 249.9318,
                  "fiftyDayAverageChange": 20.208221,
                  "fiftyDayAverageChangePercent": 0.080854945,
                  "fiftyTwoWeekChangePercent": 18.709337,
                  "fiftyTwoWeekHigh": 277.32,
                  "fiftyTwoWeekHighChange": -7.1799927,
                  "fiftyTwoWeekHighChangePercent": -0.02589064,
                  "fiftyTwoWeekLow": 169.21,
                  "fiftyTwoWeekLowChange": 100.93001,
                  "fiftyTwoWeekLowChangePercent": 0.59647775,
                  "fiftyTwoWeekRange": {
                    "high": 277.32,
                    "low": 169.21
                  },
                  "financialCurrency": "USD",
                  "firstTradeDateMilliseconds": "1980-12-12T14:30:00.000Z",
                  "forwardPE": 32.50782,
                  "fullExchangeName": "NasdaqGS",
                  "gmtOffSetMilliseconds": -18000000,
                  "hasPrePostMarketData": true,
                  "isEarningsDateEstimate": true,
                  "language": "en-US",
                  "longName": "Apple Inc.",
                  "market": "us_market",
                  "marketCap": 3991684251648,
                  "marketState": "PRE",
                  "messageBoardId": "finmb_24937",
                  "preMarketChange": -0.89001465,
                  "preMarketChangePercent": -0.3294642,
                  "preMarketPrice": 269.25,
                  "preMarketTime": "2025-11-06T09:56:42.000Z",
                  "priceEpsCurrentYear": 32.90402,
                  "priceHint": 2,
                  "priceToBook": 54.125427,
                  "quoteSourceName": "Nasdaq Real Time Price",
                  "quoteType": "EQUITY",
                  "region": "US",
                  "regularMarketChange": 0.100006,
                  "regularMarketChangePercent": 0.0370338,
                  "regularMarketDayHigh": 271.7,
                  "regularMarketDayLow": 266.93,
                  "regularMarketDayRange": {
                    "high": 271.7,
                    "low": 266.93
                  },
                  "regularMarketOpen": 268.59,
                  "regularMarketPreviousClose": 270.04,
                  "regularMarketPrice": 270.14,
                  "regularMarketTime": "2025-11-05T21:00:01.000Z",
                  "regularMarketVolume": 40361476,
                  "sharesOutstanding": 14776353000,
                  "shortName": "Apple Inc.",
                  "sourceInterval": 15,
                  "symbol": "AAPL",
                  "tradeable": false,
                  "trailingAnnualDividendRate": 1.02,
                  "trailingAnnualDividendYield": 0.003777218,
                  "trailingPE": 36.2118,
                  "triggerable": true,
                  "twoHundredDayAverage": 223.70625,
                  "twoHundredDayAverageChange": 46.43376,
                  "twoHundredDayAverageChangePercent": 0.20756577,
                  "typeDisp": "Equity"
                }
              ],
              "type": "text"
            }
          ]
        },
        "timestamp": 0
      }
    ],
    "pRFQ": [
      {
        "value": {
          "KOLevel": 130,
          "Maturity": 30,
          "PathNum": 1000,
          "Rate": 0.03,
          "ReqID": "REQ-001",
          "Spot": 100,
          "Strike": 105,
          "Underlying": "AAPL",
          "Vol": 0.2
        },
        "timestamp": 0
      }
    ]
  },
  "subWorkflows": []
}